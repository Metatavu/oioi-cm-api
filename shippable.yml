language: java
jdk: openjdk11
branches:
  only:
    - master
    
env:
  global:

build:
  cache: true
  cache_dir_list:
    - ~/.m2
  ci:
    - mvn clean package
    - docker build -t oioi-cm-api:$BRANCH.BUILD_NUMBER .
    - docker tag $(docker images -q oioi-cm-api) 414711980085.dkr.ecr.eu-central-1.amazonaws.com/oioi-cm-api:$BRANCH.BUILD_NUMBER
  post_ci:
    - docker push 414711980085.dkr.ecr.eu-central-1.amazonaws.com/oioi-cm-api:$BRANCH.BUILD_NUMBER
    
integrations:
  hub:
    - integrationName: awskeys
      type: ecr
      region: eu-central-1

